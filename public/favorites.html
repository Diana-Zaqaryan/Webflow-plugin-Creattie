<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<h1>Favorites</h1>

<div class="filters">
  <select id="assets-in-favorites" name="assets"  onchange="handleSelectionChangeInMain()">
    <option value="1" selected style="'font-family: Carter One, system-ui;'">Animated illustrations</option>
    <option value="2" style="'font-family: Carter One, system-ui;'">Illustrations</option>
    <option value="3" style="'font-family: Carter One, system-ui;'">Animated Icons</option>
    <option value="4" style="'font-family: Carter One, system-ui;'">Icons</option>
  </select>

  <div id="loading-indicator">
    <div class="load">
      <figure class="loader">
        <div class="dot white"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </figure>
    </div>
  </div>

  <div class="cards-wrapper">
    <div class="cards-content">
      <div id="data-container"></div>
    </div>
  </div>

  <div class="buttons-wrapper" id="navigation-buttons">
    <button>Previous</button>
    <button>Next</button>
  </div>

</div>


<script>
  var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
      function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
      step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
  };

  document.addEventListener("DOMContentLoaded", function() {
    const assetsDropdown = document.getElementById('assets-in-favorites');
    assetsDropdown.value = '1';
    fetchFavoriteData(1, 1)
  });

  document.getElementById('assets-in-favorites').addEventListener('change', (event) => {
    selectedCategory = event.target.value;
    style = ''
    fetchFavoriteData(selectedCategory, 1);
    resetSearchValue()
    resetSelectedStyle();
  });



  function fetchFavoriteData(category, page) {
    const url = `https://creattie.com/saved/filter?category=${category}&page=${page}`
    fetchAnimatedIllustrations(url)
  }

  function fetchAnimatedIllustrations(url) {
    return __awaiter(this, void 0, void 0, function* () {
      try {
        document.getElementById('loading-indicator').style.display = 'block';
        const response = yield fetch(url);
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        const data = yield response.json();
        const dataContainer = document.getElementById('data-container');
        dataContainer.innerHTML = '';
        lastPage= data.lastPage;
        data.products.forEach(product => {
          if (product.small_video_path) {
            const productDiv = document.createElement('div');
            productDiv.classList.add('product');
            const video = document.createElement('video');
            video.setAttribute('width', '100%');
            video.setAttribute('loop', 'loop');
            video.setAttribute('autoplay', 'autoplay');
            const source = document.createElement('source');
            source.setAttribute('src', product.small_video_path);
            source.setAttribute('type', 'video/mp4');
            video.appendChild(source);
            productDiv.appendChild(video)
            productDiv.addEventListener('click', function() {
              openProductDetailPage(product)
            });
            dataContainer.appendChild(productDiv);
          }
          return product
        });
        !data.products.length ? setNotFoundDisplays(false) : setNotFoundDisplays(true)
        document.getElementById('loading-indicator').style.display = 'none';
      }
      catch (error) {
        console.error('Error fetching data: ', error);
      }
    });
  }

</script>

</body>
</html>